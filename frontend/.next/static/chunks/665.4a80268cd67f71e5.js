"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[665],{9665:(e,a,t)=>{t.r(a),t.d(a,{default:()=>o});var n=t(7876),i=t(9099),s=t(4232),r=t(5364);let o=(0,s.memo)(e=>{let{isOpen:a,onClose:t}=e,[o,l]=(0,s.useState)(""),[c,u]=(0,s.useState)([]),[d,p]=(0,s.useState)([]),[h,f]=(0,s.useState)(!1),[g,m]=(0,s.useState)(!1),b=(0,s.useRef)(null),C=(0,s.useRef)(null),w=(0,i.useRouter)(),k=(0,s.useCallback)(async()=>{if(h||g)return;m(!0);let e=r.env.NEXT_PUBLIC_API_BASE||"/api",a=[{apiPath:"budget-data",baseClientRoute:"/extra-income/budget",identifier:"budget-data"},{apiPath:"freelance-jobs",baseClientRoute:"/extra-income/freelancers",identifier:"freelance-jobs"},{apiPath:"money-making-apps",baseClientRoute:"/extra-income/money-making-apps",identifier:"money-making-apps"},{apiPath:"shopping-deals",baseClientRoute:"/shopping-deals",identifier:"shopping-deals"},{apiPath:"remote-jobs",baseClientRoute:"/extra-income/remote-jobs",identifier:"remote-jobs"},{apiPath:"start-blog",baseClientRoute:"/start-a-blog",identifier:"start-blog"},{apiPath:"breaking-news",baseClientRoute:"/breaking-news",identifier:"breaking-news"}].map(async a=>{let{apiPath:t,baseClientRoute:n,identifier:i}=a;try{let a=await fetch("".concat(e,"/").concat(t));if(!a.ok)return console.warn("Failed to fetch ".concat(t,": ").concat(a.statusText)),[];return(await a.json()).map(e=>({id:e.id,headline:e.headline,identifier:i,baseClientRoute:n,slug:e.slug,canonicalUrl:e.canonicalUrl}))}catch(e){return console.warn("Error processing or fetching ".concat(t),e),[]}});u((await Promise.all(a)).flat()),f(!0),m(!1)},[h,g]);(0,s.useEffect)(()=>{if(a&&!h&&k(),a&&C.current){let e=setTimeout(()=>{var e;return null==(e=C.current)?void 0:e.focus()},50);return()=>clearTimeout(e)}},[a,h,k]),(0,s.useEffect)(()=>{if(""===o.trim())return void p([]);if(h){let e=o.toLowerCase();p(c.filter(a=>a.headline.toLowerCase().includes(e)))}},[o,c,h]),(0,s.useEffect)(()=>{let e=e=>{b.current&&!b.current.contains(e.target)&&t()};return a&&document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[a,t]);let v=(0,s.useCallback)(e=>{t(),l(""),p([]);let a="";if("shopping-deals"===e.identifier)if(e.canonicalUrl)a=e.canonicalUrl;else if(e.slug)a="/shopping-deals/products/".concat(e.slug);else{let t="".concat(e.id,"-").concat(e.headline.toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""));a="/shopping-deals/products/".concat(t),console.warn("Shopping deal slug generated on client, API should ideally provide it.",e)}else a="".concat(e.baseClientRoute,"/").concat(e.id);a?w.push(a):console.warn("Could not determine route for post:",e)},[w,t]);return(0,n.jsxs)("div",{ref:b,className:"search-bar-container ".concat(a?"open":"closed"),children:[(0,n.jsx)("input",{ref:C,type:"text",placeholder:g?"Loading data...":"Search posts...",value:o,onChange:e=>l(e.target.value),className:"search-bar","aria-label":"Search posts",disabled:g||!h}),!g&&h&&d.length>0&&(0,n.jsx)("ul",{className:"suggestions-list",children:d.map(e=>(0,n.jsx)("li",{onClick:()=>v(e),children:e.headline},"".concat(e.identifier,"-").concat(e.id)))}),g&&(0,n.jsx)("div",{className:"search-loading",children:"Loading search data..."}),!g&&h&&""!==o.trim()&&0===d.length&&(0,n.jsx)("div",{className:"search-no-results",children:"No matches found."})]})})}}]);