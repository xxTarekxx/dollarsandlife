exports.id=55,exports.ids=[55],exports.modules={237:(e,t)=>{"use strict";Object.defineProperty(t,"A",{enumerable:!0,get:function(){return s}});var s=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})},480:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{A:()=>u}),s(8732);var i=s(2015);s(2326),s(3247);var n=s(3796),o=s(2519),l=s(2965),r=e([n,o]);[n,o]=r.then?(await r)():r;let u=({onClose:e,auth:t})=>{let[s,a]=(0,i.useState)(null),[n,o]=(0,i.useState)(!1),[r,u]=(0,l.useAuthState)(t),[c,d]=(0,i.useState)(!1),h=(0,i.useMemo)(()=>null,[]),p=(0,i.useMemo)(()=>null,[]);(0,i.useEffect)(()=>{if(h&&p)return h.appendChild(p),requestAnimationFrame(()=>{o(!0)}),()=>{h.contains(p)&&h.removeChild(p)}},[p,h]);let g=(0,i.useCallback)(()=>{o(!1),d(!1),setTimeout(()=>{e()},250)},[e]);return(0,i.useEffect)(()=>{u||!r||c||"login"!==s&&null!==s||g()},[r,u,s,g,c,t]),(0,i.useCallback)(()=>{d(!1),g()},[g]),(0,i.useCallback)(()=>{d(!0)},[]),null};a()}catch(e){a(e)}})},1173:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{C:()=>u,initializeFirebaseAndGetServices:()=>r});var i=s(6551),n=s(6958),o=s(4337),l=e([i,n,o]);[i,n,o]=l.then?(await l)():l;let c={apiKey:"AIzaSyDDc0ctdb9HAtfKBFMcLb_-oZzhA61ZSKc",authDomain:"dollarsandlifeforum.firebaseapp.com",projectId:"dollarsandlifeforum",storageBucket:"dollarsandlifeforum.firebasestorage.app",messagingSenderId:"965261990077",appId:"1:965261990077:web:b219509b5d2ab678583fd4"},d=null,h=null,p=null,g=null;function r(){return g||(g=(async()=>{if(d||(d=(0,i.initializeApp)(c),h=(0,n.getAuth)(d),p=(0,o.getFirestore)(d),console.log("Firebase: Production environment. Connecting to live services.")),!d||!h||!p)throw Error("Firebase initialization failed: One or more services are null after initialization attempt.");return{app:d,auth:h,db:p}})()),g}async function u(){let{auth:e}=await r();return e}a()}catch(e){a(e)}})},1413:(e,t)=>{"use strict";Object.defineProperty(t,"M",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},2519:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{A:()=>g});var i=s(8732),n=s(4233),o=s(2015),l=s(8380),r=s.n(l),u=s(6958),c=s(1173),d=e([u,c]);[u,c]=d.then?(await d)():d;let h=()=>(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 98.38 24.76",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("path",{fill:"#e94235",d:"M0,3.38v3l3.44,3.33,4.06,2.3.75-5.05-.75-4.7-2.1-1.57C3.17-.99,0,.6,0,3.38Z"}),(0,i.jsx)("path",{fill:"#ffba00",d:"M25.5,2.26l-.75,4.76.75,4.99,3.68-1.82,3.82-3.8v-3c0-2.78-3.17-4.37-5.4-2.7l-2.1,1.57Z"}),(0,i.jsx)("path",{fill:"#2684fc",d:"M2.25,24.76h5.25v-12.75L0,6.38v16.12c0,1.24,1.01,2.25,2.25,2.25Z"}),(0,i.jsx)("path",{fill:"#00ac47",d:"M25.5,24.76h5.25c1.24,0,2.25-1.01,2.25-2.25V6.38l-7.5,5.62v12.75Z"}),(0,i.jsx)("path",{fill:"#c5221f",d:"M16.5,9.01L7.5,2.26v9.75l9,6.75,9-6.75V2.26l-9,6.75Z"})]}),p=()=>(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 1033.7455 220.69501",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("path",{d:"m104.87 104.87h-104.87v-104.87h104.87v104.87z",fill:"#f1511b"}),(0,i.jsx)("path",{d:"m220.65 104.87h-104.87v-104.87h104.87v104.87z",fill:"#80cc28"}),(0,i.jsx)("path",{d:"m104.86 220.7h-104.86v-104.87h104.86v104.87z",fill:"#00adef"}),(0,i.jsx)("path",{d:"m220.65 220.7h-104.87v-104.87h104.87v104.87z",fill:"#fbbc09"})]}),g=({onSwitchToLogin:e,onSuccessfulSocialLogin:t,onEmailSignUpPendingVerification:s,auth:a})=>{let[l,d]=(0,o.useState)(""),[g,f]=(0,o.useState)(""),[m,v]=(0,o.useState)(""),[x,_]=(0,o.useState)(""),[y,b]=(0,o.useState)(""),[w,j]=(0,o.useState)(""),[S,A]=(0,o.useState)(!1),[B,P]=(0,o.useState)(!1),[N,C]=(0,o.useState)(""),L=(0,n.useRouter)(),[M,k]=(0,o.useState)(a||null),[F,I]=(0,o.useState)(!!a);(0,o.useEffect)(()=>{a||F?a&&M!==a&&k(a):(console.log("SignUp.tsx: Auth not provided via prop, attempting to get/initialize."),(0,c.C)().then(e=>{console.log("SignUp.tsx: Auth initialized/retrieved via getFirebaseAuth."),k(e),I(!0)}).catch(e=>{console.error("SignUp.tsx: Failed to initialize Firebase Auth:",e),b("Authentication service failed to load. Please try again later."),I(!0)}))},[a,F,M]);let E=e=>{let t=[];return e.length<8&&t.push("At least 8 characters"),/[A-Z]/.test(e)||t.push("An uppercase letter"),/[a-z]/.test(e)||t.push("A lowercase letter"),/[0-9]/.test(e)||t.push("A number"),/[^A-Za-z0-9]/.test(e)||t.push("A special character"),t};(0,o.useEffect)(()=>{if(m){let e=E(m);e.length>0?C(`Needs: ${e.join(", ")}.`):C("Password strength: Good")}else C("")},[m]),(0,o.useEffect)(()=>{if(!M)return;let e=(0,u.onAuthStateChanged)(M,e=>{e&&"/signup"===L.pathname&&(console.log("User already logged in on /signup page, redirecting to /forum"),L.replace("/forum"))});return()=>e()},[L,M]);let U=e=>{t?t():"/signup"===L.pathname?(j(`Welcome, ${e.displayName||"User"}! Redirecting...`),setTimeout(()=>{L.replace("/forum")},2e3)):j(`Welcome, ${e.displayName||"User"}!`)},V=async e=>{if(e.preventDefault(),!M)return void b("Authentication service is not ready. Please try again.");if(b(""),j(""),P(!1),!l.trim())return void b("Display Name cannot be empty.");let t=E(m);if(t.length>0)return void b(`Password issues: ${t.join(", ")}.`);if(m!==x)return void b("Passwords do not match.");A(!0);try{let e=(await (0,u.createUserWithEmailAndPassword)(M,g,m)).user;await (0,u.updateProfile)(e,{displayName:l.trim()});let t={url:`${window.location.origin}/auth/action`,handleCodeInApp:!0};await (0,u.sendEmailVerification)(e,t),j("Sign up successful! A verification email has been sent. Please check your inbox (and spam folder) to verify your account."),P(!0),s&&s()}catch(e){console.error("Error signing up via email:",e.code,e.message),"auth/email-already-in-use"===e.code?b("This email address is already in use. Try logging in instead."):"auth/weak-password"===e.code?b("Password is too weak. Please choose a stronger password."):b(e.message||"Failed to create an account. Please try again.")}finally{A(!1)}},$=async e=>{if(!M)return void b("Authentication service is not ready. Please try again.");b(""),j(""),A(!0),P(!1);try{let t=(await (0,u.signInWithPopup)(M,e)).user;U(t)}catch(e){console.error("Error with social sign-in:",e.code,e.message),"auth/popup-closed-by-user"===e.code||"auth/cancelled-popup-request"===e.code?b("Sign-in process was cancelled."):"auth/account-exists-with-different-credential"===e.code?b("An account already exists with this email address but different sign-in credentials. Try signing in with the original method."):b(e.message||"Failed to sign in. Please try again.")}finally{A(!1)}};return M||F||a?B?(console.log("SIGNUP.TSX: Now rendering success display block."),(0,i.jsx)("div",{className:r().signupContentWrapper,children:(0,i.jsxs)("div",{className:r().signupForm,children:[(0,i.jsx)("h3",{children:"Account Created"}),w&&(0,i.jsx)("p",{className:r().successMessage,children:w}),(0,i.jsx)("div",{className:r().authLinks,style:{marginTop:"20px",textAlign:"center"},children:(0,i.jsx)("p",{children:"Once verified, you will be able to log in."})})]})})):(0,i.jsx)("div",{className:r().signupContentWrapper,children:(0,i.jsxs)("form",{onSubmit:V,className:r().signupForm,children:[(0,i.jsx)("h3",{children:"Create Your Account"}),w&&!B&&(0,i.jsx)("p",{className:r().successMessage,children:w}),y&&(0,i.jsx)("p",{className:r().errorMessage,children:y}),(0,i.jsxs)("div",{className:r().formGroup,children:[(0,i.jsx)("label",{htmlFor:"signup-display-name",children:"Display Name"}),(0,i.jsx)("input",{type:"text",id:"signup-display-name",value:l,onChange:e=>d(e.target.value),required:!0,disabled:S||!M,autoComplete:"name"})]}),(0,i.jsxs)("div",{className:r().formGroup,children:[(0,i.jsx)("label",{htmlFor:"signup-email",children:"Email"}),(0,i.jsx)("input",{type:"email",id:"signup-email",value:g,onChange:e=>f(e.target.value),required:!0,disabled:S||!M,autoComplete:"email"})]}),(0,i.jsxs)("div",{className:r().formGroup,children:[(0,i.jsx)("label",{htmlFor:"signup-password",children:"New Password"}),(0,i.jsx)("input",{type:"password",id:"signup-password",value:m,onChange:e=>v(e.target.value),required:!0,disabled:S||!M,autoComplete:"new-password"}),N&&(0,i.jsx)("p",{className:`${r().passwordStrengthMessage} ${N.includes("Good")?r().good:r().issues}`,children:N})]}),(0,i.jsxs)("div",{className:r().formGroup,children:[(0,i.jsx)("label",{htmlFor:"signup-confirm-password",children:"Confirm Password"}),(0,i.jsx)("input",{type:"password",id:"signup-confirm-password",value:x,onChange:e=>_(e.target.value),required:!0,disabled:S||!M,autoComplete:"new-password"})]}),(0,i.jsx)("button",{type:"submit",className:r().submitButton,disabled:S||!M,children:S?"Creating Account...":"Sign Up with Email"}),(0,i.jsx)("div",{className:r().socialLoginDivider,children:"OR"}),(0,i.jsxs)("div",{className:r().socialLoginButtons,children:[(0,i.jsx)("button",{type:"button",onClick:()=>$(new u.GoogleAuthProvider),className:`${r().socialButton} ${r().googleButton}`,disabled:S||!M,title:"Sign up with Google",children:(0,i.jsx)(h,{})}),(0,i.jsx)("button",{type:"button",onClick:()=>$(new u.OAuthProvider("microsoft.com")),className:`${r().socialButton} ${r().microsoftButton}`,disabled:S||!M,title:"Sign up with Microsoft",children:(0,i.jsx)(p,{})})]}),(0,i.jsx)("div",{className:r().authLinks,children:(0,i.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e?e():L.push("/login")},className:r().authSwitchLink,children:"Already have an account? Log In"})})]})}):(0,i.jsx)("div",{className:r().signupContentWrapper,children:(0,i.jsx)("p",{children:"Loading sign up..."})})};a()}catch(e){a(e)}})},3247:e=>{e.exports={authModalOverlay:"AuthPromptModal_authModalOverlay__LdVKd",fadeIn:"AuthPromptModal_fadeIn__Kie74",fadeInOverlay:"AuthPromptModal_fadeInOverlay__VIvMF",fadeOut:"AuthPromptModal_fadeOut__1qCOL",fadeOutOverlay:"AuthPromptModal_fadeOutOverlay__FP3ym",authModalContent:"AuthPromptModal_authModalContent__6Uaa7",authModalButtons:"AuthPromptModal_authModalButtons__vLQRT",authCloseBtn:"AuthPromptModal_authCloseBtn__9qq0F",popInModal:"AuthPromptModal_popInModal__m6YYf"}},3527:e=>{e.exports={feedbackButtonsContainer:"VoteButtons_feedbackButtonsContainer__JaKFa",feedbackActions:"VoteButtons_feedbackActions__hyrjY",feedbackButton:"VoteButtons_feedbackButton__jX3ZA",feedbackButtonSelected:"VoteButtons_feedbackButtonSelected__5Fa9c",feedbackButtonHelpfulSelected:"VoteButtons_feedbackButtonHelpfulSelected__ogxLm",feedbackButtonNotHelpfulSelected:"VoteButtons_feedbackButtonNotHelpfulSelected__ePHKT",helpfulnessStatText:"VoteButtons_helpfulnessStatText__Dxuk9",helpfulnessBarContainer:"VoteButtons_helpfulnessBarContainer__35srP",helpfulnessBarForeground:"VoteButtons_helpfulnessBarForeground__EscMO",isAuthor:"VoteButtons_isAuthor__tMnAS"}},3796:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{A:()=>m});var i=s(8732),n=s(6958),o=s(9918),l=s.n(o),r=s(4233),u=s(2015),c=s(1173),d=s(5223),h=s.n(d),p=e([n,c]);[n,c]=p.then?(await p)():p;let g=()=>(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 98.38 24.76",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("path",{fill:"#e94235",d:"M0,3.38v3l3.44,3.33,4.06,2.3.75-5.05-.75-4.7-2.1-1.57C3.17-.99,0,.6,0,3.38Z"}),(0,i.jsx)("path",{fill:"#ffba00",d:"M25.5,2.26l-.75,4.76.75,4.99,3.68-1.82,3.82-3.8v-3c0-2.78-3.17-4.37-5.4-2.7l-2.1,1.57Z"}),(0,i.jsx)("path",{fill:"#2684fc",d:"M2.25,24.76h5.25v-12.75L0,6.38v16.12c0,1.24,1.01,2.25,2.25,2.25Z"}),(0,i.jsx)("path",{fill:"#00ac47",d:"M25.5,24.76h5.25c1.24,0,2.25-1.01,2.25-2.25V6.38l-7.5,5.62v12.75Z"}),(0,i.jsx)("path",{fill:"#c5221f",d:"M16.5,9.01L7.5,2.26v9.75l9,6.75,9-6.75V2.26l-9,6.75Z"})]}),f=()=>(0,i.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 1033.7455 220.69501",xmlns:"http://www.w3.org/2000/svg",children:[(0,i.jsx)("path",{d:"m104.87 104.87h-104.87v-104.87h104.87v104.87z",fill:"#f1511b"}),(0,i.jsx)("path",{d:"m220.65 104.87h-104.87v-104.87h104.87v104.87z",fill:"#80cc28"}),(0,i.jsx)("path",{d:"m104.86 220.7h-104.86v-104.87h104.86v104.87z",fill:"#00adef"}),(0,i.jsx)("path",{d:"m220.65 220.7h-104.87v-104.87h104.87v104.87z",fill:"#fbbc09"})]}),m=({onSwitchToSignUp:e,auth:t})=>{let[s,a]=(0,u.useState)(""),[o,d]=(0,u.useState)(""),[p,m]=(0,u.useState)(""),[v,x]=(0,u.useState)(!1),_=(0,r.useRouter)(),[y,b]=(0,u.useState)(t||null),[w,j]=(0,u.useState)(!!t);(0,u.useEffect)(()=>{t||w?t&&y!==t&&b(t):(console.log("Login.tsx: Auth not provided via prop, attempting to get/initialize."),(0,c.C)().then(e=>{console.log("Login.tsx: Auth initialized/retrieved via getFirebaseAuth."),b(e),j(!0)}).catch(e=>{console.error("Login.tsx: Failed to initialize Firebase Auth:",e),m("Authentication service failed to load. Please try again later."),j(!0)}))},[t,w,y]),(0,u.useEffect)(()=>{if(!y)return;let e=(0,n.onAuthStateChanged)(y,e=>{e&&"/login"===_.pathname&&(console.log("User already logged in on /login page, redirecting to /forum"),_.replace("/forum"))});return()=>e()},[_,y]);let S=()=>{console.log("Login successful, preparing to navigate.");let e=_.query.from||"/forum";_.replace(e)},A=async e=>{if(e.preventDefault(),!y)return void m("Authentication service is not ready. Please try again.");m(""),x(!0),console.log("Attempting Firebase Email/Pass Log In:",{email:s,password:o});try{await (0,n.signInWithEmailAndPassword)(y,s,o),"/login"===_.pathname&&S()}catch(t){let e="Failed to log in. Please check your credentials.";if("object"==typeof t&&t&&"code"in t){let s=t.code;"auth/user-not-found"===s||"auth/invalid-credential"===s||"auth/wrong-password"===s?e="Invalid email or password. Please try again.":"auth/invalid-email"===s?e="The email address is not valid.":"auth/too-many-requests"===s&&(e="Access to this account has been temporarily disabled. Please reset your password or try again later.")}m(e),x(!1)}},B=async()=>{if(!y)return void m("Authentication service is not ready. Please try again.");m(""),x(!0);let e=new n.GoogleAuthProvider;try{await (0,n.signInWithPopup)(y,e),"/login"===_.pathname&&S()}catch(t){let e="Failed to sign in with Google.";if("object"==typeof t&&t&&"code"in t){let s=t.code;"auth/popup-closed-by-user"===s?e="Sign-in popup was closed. Please try again.":"auth/account-exists-with-different-credential"===s&&(e="An account with this email already exists with a different sign-in method.")}m(e),x(!1)}},P=async()=>{if(!y)return void m("Authentication service is not ready. Please try again.");m(""),x(!0);let e=new n.OAuthProvider("microsoft.com");try{await (0,n.signInWithPopup)(y,e),"/login"===_.pathname&&S()}catch(t){let e="Failed to sign in with Microsoft.";if("object"==typeof t&&t&&"code"in t){let s=t.code;"auth/popup-closed-by-user"===s?e="Sign-in popup was closed. Please try again.":"auth/account-exists-with-different-credential"===s&&(e="An account with this email already exists with a different sign-in method.")}m(e),x(!1)}};return y||w||t?(0,i.jsx)("div",{className:h().loginContentWrapper,children:(0,i.jsxs)("form",{onSubmit:A,className:h().loginForm,children:[(0,i.jsx)("h3",{children:"Log In"}),p&&(0,i.jsx)("p",{className:h().errorMessage,children:p}),(0,i.jsxs)("div",{className:h().formGroup,children:[(0,i.jsx)("label",{htmlFor:"login-email",children:"Email"}),(0,i.jsx)("input",{type:"email",id:"login-email",value:s,onChange:e=>a(e.target.value),required:!0,disabled:v||!y,placeholder:"you@example.com",autoComplete:"email"})]}),(0,i.jsxs)("div",{className:h().formGroup,children:[(0,i.jsx)("label",{htmlFor:"login-password",children:"Password"}),(0,i.jsx)("input",{type:"password",id:"login-password",value:o,onChange:e=>d(e.target.value),required:!0,disabled:v||!y,placeholder:"••••••••",autoComplete:"current-password"})]}),(0,i.jsx)("button",{type:"submit",className:h().submitButton,disabled:v||!y,children:v?"Logging In...":"Log In"}),(0,i.jsx)("div",{className:h().socialLoginDivider,children:"OR"}),(0,i.jsx)("div",{children:"Log In Using"}),(0,i.jsxs)("div",{className:h().socialLoginButtons,children:[(0,i.jsx)("button",{type:"button",onClick:B,className:`${h().socialButton} ${h().googleButton}`,disabled:v||!y,title:"Sign in with Google",children:(0,i.jsx)(g,{})}),(0,i.jsx)("button",{type:"button",onClick:P,className:`${h().socialButton} ${h().microsoftButton}`,disabled:v||!y,title:"Sign in with Microsoft",children:(0,i.jsx)(f,{})})]}),(0,i.jsxs)("div",{className:h().authLinks,children:[(0,i.jsx)(l(),{href:"/forgot-password",children:"Forgot Password?"}),(0,i.jsx)("span",{children:" | "}),(0,i.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e?e():_.push("/signup")},className:h().authSwitchLink,children:"Don't have an account? Sign Up"})]})]})}):(0,i.jsx)("div",{className:h().loginContentWrapper,children:(0,i.jsx)("p",{children:"Loading login..."})})};a()}catch(e){a(e)}})},3920:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a={budgeting:{bg:"#f59e0b",text:"#000"},saving:{bg:"#10b981",text:"#fff"},investing:{bg:"#3b82f6",text:"#fff"},credit:{bg:"#ef4444",text:"#fff"},"side hustles":{bg:"#6366f1",text:"#fff"},debt:{bg:"#e11d48",text:"#fff"},freelancing:{bg:"#14b8a6",text:"#fff"},"real estate":{bg:"#8b5cf6",text:"#fff"},taxes:{bg:"#f97316",text:"#000"},retirement:{bg:"#0ea5e9",text:"#fff"}}},5223:e=>{e.exports={loginContainer:"Login_loginContainer__gdNZQ",loginContentWrapper:"Login_loginContentWrapper__SiDsp",loginForm:"Login_loginForm__R_Iwg",formGroup:"Login_formGroup__4Jkco",submitButton:"Login_submitButton__he6ds",errorMessage:"Login_errorMessage___Tz13",authLinks:"Login_authLinks__8dIvP",authSwitchLink:"Login_authSwitchLink___Sgqu",socialLoginDivider:"Login_socialLoginDivider__IbM04",socialLoginButtons:"Login_socialLoginButtons__MS_NP",socialButton:"Login_socialButton__WwOi3",googleButton:"Login_googleButton__X4sZe",microsoftButton:"Login_microsoftButton__8fFAq"}},8380:e=>{e.exports={signupContainer:"SignUp_signupContainer___NnMG",signupContentWrapper:"SignUp_signupContentWrapper__oOQIv",signupForm:"SignUp_signupForm__Wmjz7",formGroup:"SignUp_formGroup__AMEQl",submitButton:"SignUp_submitButton__ktd_z",errorMessage:"SignUp_errorMessage__fExPo",successMessage:"SignUp_successMessage__hzVvo",passwordStrengthMessage:"SignUp_passwordStrengthMessage__ion1N",good:"SignUp_good__HONwr",issues:"SignUp_issues__qBlQw",socialLoginDivider:"SignUp_socialLoginDivider__Obpjv",socialLoginButtons:"SignUp_socialLoginButtons__Um1hd",socialButton:"SignUp_socialButton__c_Xta",googleButton:"SignUp_googleButton__simzU",microsoftButton:"SignUp_microsoftButton__qkrQN",authLinks:"SignUp_authLinks__JmSfh",authSwitchLink:"SignUp_authSwitchLink__ktCT1"}},8564:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{c:()=>o,s:()=>l});var i=s(4337),n=e([i]);i=(n.then?(await n)():n)[0];let o=async(e,t,s)=>{if(!e)throw Error("Firestore instance is required to get user vote.");if(!t||!s)return console.warn("getUserVoteForItem: Called with missing userId or itemId."),null;let a=`${t}_${s}`,n=(0,i.doc)(e,"userItemVotes",a);try{let e=await (0,i.getDoc)(n);if(e.exists())return e.data().voteType;return null}catch(e){throw console.error(`Error fetching user vote for item ${s} by user ${t}:`,e),e}},l=async(e,t,s,a,n,o,l,r)=>{if(!l)return void console.warn("castVote: authorId is missing, cannot update author's stats.");let u=(0,i.doc)(e,"post"===a?"forumPosts":`forumPosts/${r}/answers`,s),c=(0,i.doc)(e,`users/${t}/votes/${s}`),d=(0,i.doc)(e,"users",l);await (0,i.runTransaction)(e,async e=>{let t=await e.get(u),i=await e.get(c),l=await e.get(d);if(!t.exists())throw Error("Item not found");let h=t.data(),p=i.exists()?i.data():null,g=l.exists()?l.data():{totalHelpfulVotes:0,totalNotHelpfulVotes:0},f=0,m=0,v=0,x=0;n!==o?("helpful"===o?(f--,v--):"notHelpful"===o&&(m--,x--),"helpful"===n?(f++,v++):"notHelpful"===n&&(m++,x++)):"helpful"===n?(f--,v--):"notHelpful"===n&&(m--,x--),e.update(u,{helpfulVoteCount:(h.helpfulVoteCount||0)+f,notHelpfulVoteCount:(h.notHelpfulVoteCount||0)+m}),p&&n===o?e.delete(c):e.set(c,{voteType:n,itemId:s,itemType:a,...r&&{postId:r}},{merge:!0}),e.update(d,{totalHelpfulVotes:(g.totalHelpfulVotes||0)+v,totalNotHelpfulVotes:(g.totalNotHelpfulVotes||0)+x})})};a()}catch(e){a(e)}})},8874:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(8732),i=s(2341),n=s.n(i),o=s(2770);class l extends n(){static async getInitialProps(e){let t=new o.ServerStyleSheet,s=e.renderPage;try{e.renderPage=()=>s({enhanceApp:e=>s=>t.collectStyles((0,a.jsx)(e,{...s}))});let i=await n().getInitialProps(e);return{...i,styles:(0,a.jsxs)(a.Fragment,{children:[i.styles,t.getStyleElement()]})}}finally{t.seal()}}render(){return(0,a.jsxs)(i.Html,{lang:"en",children:[" ",(0,a.jsx)(i.Head,{}),(0,a.jsxs)("body",{children:[(0,a.jsx)(i.Main,{}),(0,a.jsx)(i.NextScript,{})]})]})}}},9924:(e,t,s)=>{"use strict";s.a(e,async(e,a)=>{try{s.d(t,{A:()=>h});var i=s(8732),n=s(2015),o=s(3527),l=s.n(o),r=s(6958),u=s(2893),c=s(8564),d=e([r,u,c]);[r,u,c]=d.then?(await d)():d;let h=({itemId:e,initialHelpfulVotes:t,initialNotHelpfulVotes:s,itemType:a,itemAuthorId:o,postIdForItem:d,auth:h,db:p})=>{let[g,f]=(0,n.useState)(t),[m,v]=(0,n.useState)(s),[x,_]=(0,n.useState)(null),[y,b]=(0,n.useState)(!0),[w,j]=(0,n.useState)(!1),[S,A]=(0,n.useState)(null);(0,n.useEffect)(()=>{f(t),v(s)},[t,s]),(0,n.useEffect)(()=>{let t=(0,r.onAuthStateChanged)(h,t=>{A(t),t&&e&&p?(b(!0),(0,c.c)(p,t.uid,e).then(e=>{_(e)}).catch(e=>{console.error("VoteButtons: Error fetching user's current vote:",e)}).finally(()=>{b(!1)})):(_(null),b(!1))});return()=>t()},[e,h,p]);let B=(0,n.useCallback)(async t=>{if(!S)return void u.default.error("Please log in to vote.");if(S.uid===o)return void u.default.error("You cannot vote on your own "+a+".");if(w||!p){p||u.default.error("Database service unavailable.");return}j(!0);let s=g,i=m,n=null;t===x?("helpful"===t?s--:i--,n=null):("helpful"===t?(s++,"notHelpful"===x&&i--):(i++,"helpful"===x&&s--),n=t),f(s),v(i),_(n);try{await (0,c.s)(p,S.uid,e,a,t,x,o,"answer"===a?d:void 0)}catch(t){let e="object"==typeof t&&t&&"message"in t&&"string"==typeof t.message?t.message:"Failed to submit vote. Please try again.";console.error("VoteButtons: Error submitting vote:",t),u.default.error(e??"Failed to submit vote. Please try again."),f(g),v(m),_(x)}finally{j(!1)}},[S,o,a,w,g,m,x,e,d,p]),P=g+m,N=P>0?g/P*100:0;if(o&&S&&o===S.uid)return(0,i.jsxs)("div",{className:`${l().feedbackButtonsContainer} ${l().isAuthor}`,children:[P>0&&(0,i.jsxs)("div",{className:"helpfulness-stat",children:[(0,i.jsxs)("p",{className:l().helpfulnessStatText,children:[g," of ",P," user",1===P?"":"s"," ","found this helpful."]}),(0,i.jsx)("div",{className:l().helpfulnessBarContainer,children:(0,i.jsx)("div",{className:l().helpfulnessBarForeground,style:{width:`${N}%`}})})]}),0===P&&!y&&(0,i.jsxs)("p",{className:l().helpfulnessStatText,children:["No votes yet (this is your ",a,")."]}),y&&(0,i.jsx)("p",{className:l().helpfulnessStatText,children:"Loading stats..."})]});let C={disabled:w||y||!S||!p};return(0,i.jsxs)("div",{className:l().feedbackButtonsContainer,children:[(0,i.jsxs)("div",{className:l().feedbackActions,children:[(0,i.jsx)("button",{onClick:()=>B("helpful"),className:`${l().feedbackButton} ${"helpful"===x?l().feedbackButtonHelpfulSelected:""}`,...C,title:S?"helpful"===x?"Remove helpful vote":"Mark as helpful":"Log in to vote",children:"Helpful"}),(0,i.jsx)("button",{onClick:()=>B("notHelpful"),className:`${l().feedbackButton} ${"notHelpful"===x?l().feedbackButtonNotHelpfulSelected:""}`,...C,title:S?"notHelpful"===x?"Remove not helpful vote":"Mark as not helpful":"Log in to vote",children:"Not Helpful"})]}),(P>0||!y)&&(0,i.jsx)("div",{className:"helpfulness-stat",children:P>0?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{className:l().helpfulnessStatText,children:[g," of ",P," user",1===P?"":"s"," ","found this helpful."]}),(0,i.jsx)("div",{className:l().helpfulnessBarContainer,children:(0,i.jsx)("div",{className:l().helpfulnessBarForeground,style:{width:`${N}%`}})})]}):!y&&(0,i.jsx)("p",{className:l().helpfulnessStatText,children:"No votes yet."})}),y&&(0,i.jsx)("p",{className:l().helpfulnessStatText,children:"Loading votes..."})]})};a()}catch(e){a(e)}})}};